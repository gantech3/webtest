<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <title>HTML</title>
 </head>
 <body>
   <h1>HTML</h1>
   <p>GAS JSON load Test 11.</p>
   <script>
	const url = 'https://script.google.com/macros/s/AKfycbzylyRc4N3mqB9uX5gNpEjIsHJ_bE_Ccikpq-ZpOm1mP4AVIkvU6lfipW_wNwd1nObA/exec';
	const formData = new URLSearchParams();
	formData.append('id', 'aoki');
	formData.append('mode', 'read');
	formData.append('value', '1');

/*
	// x-www-form-urlencodedでデータを送り、テキストで取得する
	document.write("x-www-form-urlencoded fetch start");
	const urlencodedToText = {
		method: 'POST',
                headers: {
         		'Content-Type' : 'application/x-www-form-urlencoded',
                },
		body: 'id=aoki&mode=read&value=1'
//		body:'id=minami&mode=date&value=2024/4/22'
//		body: formData	// こっちでもOK
    	};
	fetch(url, urlencodedToText)
                .then(response => response.text())
                .then(data => {
                    document.write("text="+data+"!");
                })
                .catch(error => console.error('Error:', error));
*/
/**/	   
	// text/plain扱いでJSONデータを送受信する
	document.write("text/plain fetch start");
    	const plainToJson = {
		method: 'POST',
                headers: {
	    		'Content-Type': 'text/plain',
		},
  		body: JSON.stringify({
//   			"id": "aoki",
//   			"mode": "read",
//   			"value": "1"
			"id":"minami","mode":"date","value":"2024/4/22"
		})
	};
	document.write("in="+plainToJson.body+"!");

	fetch(url, plainToJson)
                .then(response => response.json())
                .then(data => {
//			document.write("<p>mode="+data.mode+"!name="+data.value.name+"!</p>");
//			document.write("<p>mark="+data.value[0].mark+"!value="+data.value[1].value+"!</p>");
			document.write("<p>json="+(JSON.stringify(data))+"!</p>");
                })
                .catch(error => console.error('Error:', error));
/**/
	</script>
 </body>
</html>
